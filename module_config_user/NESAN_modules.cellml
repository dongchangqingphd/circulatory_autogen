<?xml version='1.0' encoding='UTF-8'?>
<model name="modules" xmlns="http://www.cellml.org/cellml/1.1#" xmlns:cellml="http://www.cellml.org/cellml/1.1#">
    <!-- Your code goes here-->
    <!--**************************SAN cell membrane potential module****************//-->
    <component name="HH_simple">
        <variable name="t" public_interface="in" units="second"/>
        <!--some physical constant
universal gas constant-->
        <variable name="R" public_interface="in" units="joule_per_kilomole_kelvin"/>
        <!--absolute temperature for 37 centidegree-->
        <variable name="T" public_interface="in" units="kelvin"/>
        <!--Faraday constant-->
        <variable name="F" public_interface="in" units="coulomb_per_mole"/>
        <!--cell capacitance-->
        <variable name="C" public_interface="in" units="microF"/>
        <!--declare and initilize the V_ode variable-->
        <variable name="V_init" public_interface="in" units="millivolt"/>
        <variable name="clamp_mode" public_interface="in" units="dimensionless"/>
        <!--clamp mode condition-->
        <variable name="V_clamp" public_interface="in" units="millivolt"/>
        <!--declare different ion current-->
        <variable name="i_f" public_interface="in" units="nanoA"/>
        <variable name="i_KACh" public_interface="in" units="nanoA"/>
        <variable name="i_to" public_interface="in" units="nanoA"/>
        <variable name="i_Na" public_interface="in" units="nanoA"/>
        <variable name="i_NaK" public_interface="in" units="nanoA"/>
        <variable name="i_NaCa" public_interface="in" units="nanoA"/>
        <variable name="i_Kur" public_interface="in" units="nanoA"/>
        <variable name="i_CaL" public_interface="in" units="nanoA"/>
        <variable name="i_Ks" public_interface="in" units="nanoA"/>
        <variable name="i_Kr" public_interface="in" units="nanoA"/>
        <variable name="i_CaT" public_interface="in" units="nanoA"/>
        <!--output parameters-->
        <variable name="RTONF" public_interface="out" units="millivolt"/>
        <variable name="i_tot" public_interface="out" units="nanoA"/>
        <variable name="V" public_interface="out" units="millivolt"/>
        <variable initial_value="V_init" name="V_ode" units="millivolt"/>
        <!--calculated constant value-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>RTONF</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>R</ci>
                        <ci>T</ci>
                    </apply>
                    <ci>F</ci>
                </apply>
            </apply>
            <!--declare a total current variable-->
            <apply>
                <eq/>
                <ci>i_tot</ci>
                <apply>
                    <plus/>
                    <ci>i_f</ci>
                    <ci>i_KACh</ci>
                    <ci>i_to</ci>
                    <ci>i_Na</ci>
                    <ci>i_NaK</ci>
                    <ci>i_NaCa</ci>
                    <ci>i_Kur</ci>
                    <ci>i_CaL</ci>
                    <ci>i_Ks</ci>
                    <ci>i_Kr</ci>
                    <ci>i_CaT</ci>
                </apply>
            </apply>
            <!--classic formula-->
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>V_ode</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>i_tot</ci>
                    </apply>
                    <ci>C</ci>
                </apply>
            </apply>
            <!--if preset 1, never use differential formula to calculate the action potential-->
            <apply>
                <eq/>
                <ci>V</ci>
                <piecewise>
                    <piece>
                        <ci>V_clamp</ci>
                        <apply>
                            <geq/>
                            <ci>clamp_mode</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>V_ode</ci>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
    </component>
    <!--**************************Voltage_clamp experiment control****************//-->
    <component name="Voltage_clamp">
        <variable name="t" public_interface="in" units="second"/>
        <!--this function used to test before modify model-->
        <variable name="t_holding" public_interface="in" units="second"/>
        <variable name="t_test" public_interface="in" units="second"/>
        <!--preset test time period, initial value is 0.5s-->
        <variable name="V_test" public_interface="in" units="millivolt"/>
        <!--only during test time, the action potential set to this value-->
        <variable name="V_holding" public_interface="in" units="millivolt"/>
        <!--other time, the action potential recovery to this value-->
        <variable name="V_clamp" public_interface="out" units="millivolt"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>V_clamp</ci>
                <piecewise>
                    <piece>
                        <ci>V_test</ci>
                        <apply>
                            <and/>
                            <apply>
                                <gt/>
                                <ci>t</ci>
                                <ci>t_holding</ci>
                            </apply>
                            <apply>
                                <lt/>
                                <ci>t</ci>
                                <apply>
                                    <plus/>
                                    <ci>t_holding</ci>
                                    <ci>t_test</ci>
                                </apply>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>V_holding</ci>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
        <!--Used to test changes in related currents observed for a specific action potential that given a specific time period-->
    </component>
    <!--**************************SNS/PNS effect SAN cell mechanism****************//-->
    <component name="NES_experiments">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="ACh_init" public_interface="in" units="nM"/>
        <variable initial_value="ACh_init" name="ACh" public_interface="out" units="nM"/>
        <variable name="ISO_init" public_interface="in" units="nM"/>
        <variable initial_value="ISO_init" name="ISO" public_interface="out" units="nM"/>
        <variable initial_value="2000" name="test_transp" public_interface="out" units="dimensionless"/>
        <variable name="cAMP_nif" public_interface="out" units="uM"/>
        <variable name="PDE_cAMP" public_interface="in" units="uM"/>
        <!--basal CaMKII mechanism maintain basal cAMP/Ca ion balance in cell-->
        <variable name="cAMP_basal" public_interface="out" units="uM"/>
        <variable name="AC_basal" public_interface="out" units="nmole"/>
        <variable name="ACCa_max" public_interface="in" units="nmol_per_umeter2"/>
        <variable name="Area_Ca" public_interface="in" units="umeter2"/>
        <variable name="EC50_Ca" public_interface="in" units="nM"/>
        <variable name="CaMKII" public_interface="in" units="nM"/>
        <variable name="AC2cAMP_conversion" public_interface="in" units="per_cmeter3"/>
        <!--ACh bind M2R process-->
        <variable name="M2_max" public_interface="in" units="nmol_per_umeter2"/>
        <variable name="M2R" public_interface="out" units="nmole"/>
        <variable name="Area_M2R" public_interface="in" units="umeter2"/>
        <variable name="IC50_M2" public_interface="in" units="nM"/>
        <variable name="k_M2bindGi" public_interface="in" units="dimensionless"/>
        <variable name="Gi_M2" public_interface="out" units="nmole"/>
        <!--ISO bind beta-AR process-->
        <variable name="beta_ntotal" public_interface="in" units="nmol_per_umeter2"/>
        <variable name="k_beta1" public_interface="in" units="dimensionless"/>
        <variable name="K_beta2" public_interface="in" units="dimensionless"/>
        <variable name="beta1_max" public_interface="out" units="nmol_per_umeter2"/>
        <variable name="beta2_max" public_interface="out" units="nmol_per_umeter2"/>
        <variable name="Area_betaAR" public_interface="in" units="umeter2"/>
        <variable name="EC50_beta1" public_interface="in" units="nM"/>
        <variable name="beta1_actived" public_interface="out" units="nmole"/>
        <variable name="EC50_beta2" public_interface="in" units="nM"/>
        <variable name="beta2_actived" public_interface="out" units="nmole"/>
        <variable name="IC50_beta2" public_interface="in" units="nM"/>
        <variable name="beta2_inhibited" public_interface="out" units="nmole"/>
        <variable name="k_b1coupleGs" public_interface="in" units="dimensionless"/>
        <variable name="Gs_beta1" public_interface="out" units="nmole"/>
        <!--high ISO lead to beta2-AR bind Gi-->
        <variable name="PKA_init" public_interface="in" units="dimensionless"/>
        <variable initial_value="PKA_init" name="PKA" public_interface="out" units="dimensionless"/>
        <variable name="T_PKAPbeta2" public_interface="in" units="dimensionless"/>
        <variable name="Gi_beta2" public_interface="out" units="nmole"/>
        <variable name="k_b2coupleGi" public_interface="in" units="dimensionless"/>
        <variable name="Gs_beta2" public_interface="out" units="nmole"/>
        <variable name="k_b2coupleGs" public_interface="in" units="dimensionless"/>
        <variable name="GS_total" public_interface="out" units="nmole"/>
        <variable name="Gi_total" public_interface="out" units="nmole"/>
        <variable name="EC50_Gs" public_interface="in" units="nmole"/>
        <variable name="k_Gi" public_interface="in" units="dimensionless"/>
        <variable name="AC_maxstimulated" public_interface="in" units="nmole"/>
        <variable name="AC_actived" public_interface="out" units="nmole"/>
        <variable name="cAMP" public_interface="out" units="uM"/>
        <variable name="T_cAMPPKA" public_interface="in" units="uM"/>
        <variable name="PKA_new" public_interface="out" units="dimensionless"/>
        <!--//*****************simplified equations about Ca to cAMP basal********************////-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>AC_basal</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>ACCa_max</ci>
                        <ci>Area_Ca</ci>
                        <apply>
                            <power/>
                            <ci>CaMKII</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <ci>EC50_Ca</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>CaMKII</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>cAMP_basal</ci>
                <apply>
                    <times/>
                    <ci>AC2cAMP_conversion</ci>
                    <ci>AC_basal</ci>
                </apply>
            </apply>
            <!--//*****************simplified equations about ACh to Gi********************////-->
            <apply>
                <eq/>
                <ci>M2R</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>M2_max</ci>
                        <ci>Area_M2R</ci>
                        <apply>
                            <power/>
                            <ci>ACh</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <ci>IC50_M2</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>ACh</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Gi_M2</ci>
                <apply>
                    <times/>
                    <ci>M2R</ci>
                    <ci>k_M2bindGi</ci>
                </apply>
            </apply>
            <!--//*****************simplified equations about ISO to Gs/Gi********************////
1st step, calculate the maximum beta1-AR proportion/number in total beta-AR of SAN cell-->
            <apply>
                <eq/>
                <ci>beta1_max</ci>
                <apply>
                    <times/>
                    <ci>beta_ntotal</ci>
                    <ci>k_beta1</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta2_max</ci>
                <apply>
                    <times/>
                    <ci>beta_ntotal</ci>
                    <ci>K_beta2</ci>
                </apply>
            </apply>
            <!--from ISO to beta-AR relationship, reference HILL equation as previous paper:<PHARMACOLOGICAL CHARACTERIZATION OF THE POST JUNCTIONAL 13-ADRENOCEPTORS IN THE RAT GASTRIC FUNDUS>-->
            <apply>
                <eq/>
                <ci>beta1_actived</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>beta1_max</ci>
                        <ci>Area_betaAR</ci>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <ci>EC50_beta1</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta2_actived</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>beta2_max</ci>
                        <ci>Area_betaAR</ci>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <ci>EC50_beta2</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta2_inhibited</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>beta2_max</ci>
                        <ci>Area_betaAR</ci>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <ci>IC50_beta2</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Gs_beta1</ci>
                <apply>
                    <times/>
                    <ci>beta1_actived</ci>
                    <ci>k_b1coupleGs</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Gi_beta2</ci>
                <piecewise>
                    <piece>
                        <cn cellml:units="nmole">0</cn>
                        <apply>
                            <lt/>
                            <ci>PKA</ci>
                            <ci>T_PKAPbeta2</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <times/>
                            <ci>beta2_inhibited</ci>
                            <ci>k_b2coupleGi</ci>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
            <!--total number of beta2-AR is limited, so, some beta2-AR phosphorylated, less Gs protein actived-->
            <apply>
                <eq/>
                <ci>Gs_beta2</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>beta2_actived</ci>
                            <ci>k_b2coupleGs</ci>
                        </apply>
                        <apply>
                            <lt/>
                            <ci>PKA</ci>
                            <ci>T_PKAPbeta2</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <minus/>
                            <apply>
                                <times/>
                                <ci>beta2_actived</ci>
                                <ci>k_b2coupleGs</ci>
                            </apply>
                            <apply>
                                <times/>
                                <ci>beta2_inhibited</ci>
                                <ci>k_b2coupleGi</ci>
                            </apply>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
            <!--//*****************simplified equations about Gs/Gi to AC********************////-->
            <apply>
                <eq/>
                <ci>GS_total</ci>
                <apply>
                    <plus/>
                    <ci>Gs_beta1</ci>
                    <ci>Gs_beta2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Gi_total</ci>
                <apply>
                    <plus/>
                    <ci>Gi_beta2</ci>
                    <ci>Gi_M2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>AC_actived</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>AC_maxstimulated</ci>
                        <ci>GS_total</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>EC50_Gs</ci>
                        <ci>GS_total</ci>
                        <apply>
                            <times/>
                            <ci>k_Gi</ci>
                            <ci>Gi_total</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--//*****************simplified equations about AC to catalyze cAMP********************////-->
            <apply>
                <eq/>
                <ci>cAMP</ci>
                <apply>
                    <times/>
                    <ci>AC2cAMP_conversion</ci>
                    <ci>AC_actived</ci>
                </apply>
            </apply>
            <!--//*****************simplified equations about total cAMP product********************////-->
            <apply>
                <eq/>
                <ci>cAMP_nif</ci>
                <apply>
                    <times/>
                    <apply>
                        <plus/>
                        <ci>PDE_cAMP</ci>
                        <ci>cAMP_basal</ci>
                        <ci>cAMP</ci>
                    </apply>
                    <cn cellml:units="dimensionless">1</cn>
                </apply>
            </apply>
            <!--//*****************simplified equation parameters about cAMP to PKA********************////
therefore, the PKA range is [0.0296->0.808->0.9922] while cAMP from 0 to infinity-->
            <apply>
                <eq/>
                <ci>PKA_new</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <plus/>
                            <apply>
                                <times/>
                                <apply>
                                    <minus/>
                                    <cn cellml:units="dimensionless">0.9483</cn>
                                </apply>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="per_uM">1</cn>
                                        </apply>
                                        <ci>cAMP_nif</ci>
                                        <cn cellml:units="dimensionless">0.0656</cn>
                                    </apply>
                                </apply>
                            </apply>
                            <cn cellml:units="dimensionless">0.9778</cn>
                        </apply>
                        <apply>
                            <lt/>
                            <ci>cAMP_nif</ci>
                            <ci>T_cAMPPKA</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <plus/>
                            <apply>
                                <times/>
                                <apply>
                                    <minus/>
                                    <cn cellml:units="dimensionless">0.4526</cn>
                                </apply>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="per_uM">1</cn>
                                        </apply>
                                        <ci>cAMP_nif</ci>
                                        <cn cellml:units="dimensionless">0.0340</cn>
                                    </apply>
                                </apply>
                            </apply>
                            <cn cellml:units="dimensionless">0.9922</cn>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
    </component>
    <!--**************************steady state variable****************//
**************************Ionic_values module****************//-->
    <component name="Ionic_values">
        <variable name="t" public_interface="in" units="second"/>
        <!--declare and define some fixed ion variable value, such as concentrations 
global constant-->
        <variable name="Cao" public_interface="in" units="millimolar"/>
        <variable name="Nao" public_interface="in" units="millimolar"/>
        <variable name="Ki" public_interface="in" units="millimolar"/>
        <variable name="Ko" public_interface="in" units="millimolar"/>
        <!--calculated variable, from other module-->
        <variable name="Nai" public_interface="in" units="millimolar"/>
        <variable name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable name="RTONF" public_interface="in" units="millivolt"/>
        <!--calculated variable, as output-->
        <variable name="E_Na" public_interface="out" units="millivolt"/>
        <variable name="E_K" public_interface="out" units="millivolt"/>
        <variable name="E_Ca" public_interface="out" units="millivolt"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>E_Na</ci>
                <apply>
                    <times/>
                    <ci>RTONF</ci>
                    <apply>
                        <ln/>
                        <apply>
                            <divide/>
                            <ci>Nao</ci>
                            <ci>Nai</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>E_K</ci>
                <apply>
                    <times/>
                    <ci>RTONF</ci>
                    <apply>
                        <ln/>
                        <apply>
                            <divide/>
                            <ci>Ko</ci>
                            <ci>Ki</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>E_Ca</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">0.5</cn>
                    <ci>RTONF</ci>
                    <apply>
                        <ln/>
                        <apply>
                            <divide/>
                            <ci>Cao</ci>
                            <ci>Ca_sub</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************Nai_concentration module****************//-->
    <component name="Nai_concentration">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="F" public_interface="in" units="coulomb_per_mole"/>
        <!--those common variable use the membrane shared-->
        <variable name="Nai_clamp" public_interface="in" units="dimensionless"/>
        <variable name="V_sub" public_interface="in" units="millimetre3"/>
        <variable name="V_i" public_interface="in" units="millimetre3"/>
        <variable name="i_Na" public_interface="in" units="nanoA"/>
        <variable name="i_NaCa" public_interface="in" units="nanoA"/>
        <variable name="i_NaK" public_interface="in" units="nanoA"/>
        <variable name="i_fNa" public_interface="in" units="nanoA"/>
        <variable name="i_siNa" public_interface="in" units="nanoA"/>
        <!--not mention on the paper, but looks like just package all Na input related variables-->
        <variable name="Nai" public_interface="out" units="millimolar"/>
        <variable initial_value="5" name="Nai_" units="millimolar"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Nai_</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>Nai_clamp</ci>
                        </apply>
                        <apply>
                            <minus/>
                            <cn cellml:units="mA_nA">1</cn>
                        </apply>
                        <apply>
                            <plus/>
                            <ci>i_Na</ci>
                            <ci>i_fNa</ci>
                            <ci>i_siNa</ci>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">3</cn>
                                <ci>i_NaK</ci>
                            </apply>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">3</cn>
                                <ci>i_NaCa</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <cn cellml:units="litre_millimetre3">1</cn>
                        <apply>
                            <plus/>
                            <ci>V_i</ci>
                            <ci>V_sub</ci>
                        </apply>
                        <ci>F</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Nai</ci>
                <ci>Nai_</ci>
            </apply>
        </math>
        <!--so, Na input variable is not a constant value, it will be change by dependences-->
    </component>
    <!--**************************Cell_parameters module****************//-->
    <component name="Cell_parameters">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="V_jsr_part" public_interface="in" units="dimensionless"/>
        <variable name="V_i_part" public_interface="in" units="dimensionless"/>
        <variable name="V_nsr_part" public_interface="in" units="dimensionless"/>
        <variable name="R_cell" public_interface="in" units="micrometre"/>
        <variable name="L_cell" public_interface="in" units="micrometre"/>
        <variable name="L_sub" public_interface="in" units="micrometre"/>
        <variable name="V_i" public_interface="out" units="millimetre3"/>
        <variable name="V_sub" public_interface="out" units="millimetre3"/>
        <variable name="V_jsr" public_interface="out" units="millimetre3"/>
        <variable name="V_nsr" public_interface="out" units="millimetre3"/>
        <variable name="V_cell" units="millimetre3"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>V_cell</ci>
                <apply>
                    <times/>
                    <cn cellml:units="micrometre_per_femtometre">0.000000001</cn>
                    <pi/>
                    <apply>
                        <power/>
                        <ci>R_cell</ci>
                        <cn cellml:units="dimensionless">2</cn>
                    </apply>
                    <ci>L_cell</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>V_sub</ci>
                <apply>
                    <times/>
                    <cn cellml:units="micrometre_per_femtometre">0.000000001</cn>
                    <cn cellml:units="dimensionless">2</cn>
                    <pi/>
                    <ci>L_sub</ci>
                    <apply>
                        <minus/>
                        <ci>R_cell</ci>
                        <apply>
                            <divide/>
                            <ci>L_sub</ci>
                            <cn cellml:units="dimensionless">2</cn>
                        </apply>
                    </apply>
                    <ci>L_cell</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>V_jsr</ci>
                <apply>
                    <times/>
                    <ci>V_jsr_part</ci>
                    <ci>V_cell</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>V_i</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>V_i_part</ci>
                        <ci>V_cell</ci>
                    </apply>
                    <ci>V_sub</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>V_nsr</ci>
                <apply>
                    <times/>
                    <ci>V_nsr_part</ci>
                    <ci>V_cell</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--***************Dynamics of Ca ion concentrations in cell compartments****************//-->
    <component name="Ca_dynamics">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="F" public_interface="in" units="coulomb_per_mole"/>
        <variable name="V_i" public_interface="in" units="millimetre3"/>
        <variable name="V_jsr" public_interface="in" units="millimetre3"/>
        <variable name="V_nsr" public_interface="in" units="millimetre3"/>
        <variable name="V_sub" public_interface="in" units="millimetre3"/>
        <variable name="i_siCa" public_interface="in" units="nanoA"/>
        <variable name="i_CaT" public_interface="in" units="nanoA"/>
        <variable name="i_NaCa" public_interface="in" units="nanoA"/>
        <variable name="j_SRCarel" public_interface="in" units="millimolar_per_second"/>
        <variable name="j_Ca_dif" public_interface="in" units="millimolar_per_second"/>
        <variable name="j_tr" public_interface="in" units="millimolar_per_second"/>
        <variable name="j_up" public_interface="in" units="millimolar_per_second"/>
        <variable name="TMC_tot" public_interface="in" units="millimolar"/>
        <variable name="CM_tot" public_interface="in" units="millimolar"/>
        <variable name="TC_tot" public_interface="in" units="millimolar"/>
        <variable name="CQ_tot" public_interface="in" units="millimolar"/>
        <variable name="delta_fTMC" public_interface="in" units="per_second"/>
        <variable name="delta_fCMi" public_interface="in" units="per_second"/>
        <variable name="delta_fCMs" public_interface="in" units="per_second"/>
        <variable name="delta_fTC" public_interface="in" units="per_second"/>
        <variable name="delta_fCQ" public_interface="in" units="per_second"/>
        <variable initial_value="9.15641e-6" name="Cai" public_interface="out" units="millimolar"/>
        <variable initial_value="0.435148" name="Ca_nsr" public_interface="out" units="millimolar"/>
        <variable initial_value="0.409551" name="Ca_jsr" public_interface="out" units="millimolar"/>
        <variable initial_value="6.226104e-5" name="Ca_sub" public_interface="out" units="millimolar"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Cai</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <minus/>
                                <apply>
                                    <times/>
                                    <ci>j_Ca_dif</ci>
                                    <ci>V_sub</ci>
                                </apply>
                                <apply>
                                    <times/>
                                    <ci>j_up</ci>
                                    <ci>V_nsr</ci>
                                </apply>
                            </apply>
                        </apply>
                        <ci>V_i</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <ci>CM_tot</ci>
                            <ci>delta_fCMi</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>TC_tot</ci>
                            <ci>delta_fTC</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>TMC_tot</ci>
                            <ci>delta_fTMC</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Ca_sub</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <ci>j_SRCarel</ci>
                            <ci>V_jsr</ci>
                        </apply>
                        <ci>V_sub</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <divide/>
                            <apply>
                                <minus/>
                                <apply>
                                    <plus/>
                                    <ci>i_siCa</ci>
                                    <ci>i_CaT</ci>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">2</cn>
                                    <ci>i_NaCa</ci>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">2</cn>
                                <ci>F</ci>
                                <ci>V_sub</ci>
                            </apply>
                        </apply>
                        <ci>j_Ca_dif</ci>
                        <apply>
                            <times/>
                            <ci>CM_tot</ci>
                            <ci>delta_fCMs</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Ca_nsr</ci>
                </apply>
                <apply>
                    <minus/>
                    <ci>j_up</ci>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <ci>j_tr</ci>
                            <ci>V_jsr</ci>
                        </apply>
                        <ci>V_nsr</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Ca_jsr</ci>
                </apply>
                <apply>
                    <minus/>
                    <ci>j_tr</ci>
                    <apply>
                        <plus/>
                        <ci>j_SRCarel</ci>
                        <apply>
                            <times/>
                            <ci>CQ_tot</ci>
                            <ci>delta_fCQ</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <!--***************SR release Ca ions in cell compartments****************//-->
    <component name="Ca_SR_release">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable name="Ca_jsr" public_interface="in" units="millimolar"/>
        <variable name="j_SRCarel" public_interface="out" units="millimolar_per_second"/>
        <variable name="diff" units="millimolar"/>
        <variable name="P_tot" units="dimensionless"/>
        <variable initial_value="0.9308" name="R" units="dimensionless"/>
        <variable initial_value="6.181512e-9" name="O" units="dimensionless"/>
        <variable initial_value="4.595622e-10" name="I" units="dimensionless"/>
        <variable initial_value="0.069199" name="RI" units="dimensionless"/>
        <variable initial_value="148041085.1" name="ks" units="per_second"/>
        <variable initial_value="15" name="MaxSR" units="dimensionless"/>
        <variable initial_value="1" name="MinSR" units="dimensionless"/>
        <variable initial_value="0.6829" name="EC50_SR" units="millimolar"/>
        <variable initial_value="2.5" name="HSR" units="dimensionless"/>
        <variable name="koSRCa" units="per_millimolar2_second"/>
        <variable name="kiSRCa" units="per_millimolar_second"/>
        <variable initial_value="10000" name="koCa" units="per_millimolar2_second"/>
        <variable initial_value="500" name="kiCa" units="per_millimolar_second"/>
        <variable name="kCaSR" units="dimensionless"/>
        <variable initial_value="5" name="kim" units="per_second"/>
        <variable initial_value="660" name="kom" units="per_second"/>
        <!--the KoCa should calibrated by formula, but I don't know how to get RyR_min and other parameters, based on Linder's paper table4-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>j_SRCarel</ci>
                <apply>
                    <times/>
                    <ci>ks</ci>
                    <ci>O</ci>
                    <apply>
                        <minus/>
                        <ci>Ca_jsr</ci>
                        <ci>Ca_sub</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>diff</ci>
                <apply>
                    <minus/>
                    <ci>Ca_jsr</ci>
                    <ci>Ca_sub</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>kCaSR</ci>
                <apply>
                    <minus/>
                    <ci>MaxSR</ci>
                    <apply>
                        <divide/>
                        <apply>
                            <minus/>
                            <ci>MaxSR</ci>
                            <ci>MinSR</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <power/>
                                <apply>
                                    <divide/>
                                    <ci>EC50_SR</ci>
                                    <ci>Ca_jsr</ci>
                                </apply>
                                <ci>HSR</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>koSRCa</ci>
                <apply>
                    <divide/>
                    <ci>koCa</ci>
                    <ci>kCaSR</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>kiSRCa</ci>
                <apply>
                    <times/>
                    <ci>kiCa</ci>
                    <ci>kCaSR</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>R</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kim</ci>
                            <ci>RI</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kiSRCa</ci>
                            <ci>Ca_sub</ci>
                            <ci>R</ci>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>koSRCa</ci>
                            <apply>
                                <power/>
                                <ci>Ca_sub</ci>
                                <cn cellml:units="dimensionless">2</cn>
                            </apply>
                            <ci>R</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kom</ci>
                            <ci>O</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>O</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>koSRCa</ci>
                            <apply>
                                <power/>
                                <ci>Ca_sub</ci>
                                <cn cellml:units="dimensionless">2</cn>
                            </apply>
                            <ci>R</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kom</ci>
                            <ci>O</ci>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kiSRCa</ci>
                            <ci>Ca_sub</ci>
                            <ci>O</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kim</ci>
                            <ci>I</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>I</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kiSRCa</ci>
                            <ci>Ca_sub</ci>
                            <ci>O</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kim</ci>
                            <ci>I</ci>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kom</ci>
                            <ci>I</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>koSRCa</ci>
                            <apply>
                                <power/>
                                <ci>Ca_sub</ci>
                                <cn cellml:units="dimensionless">2</cn>
                            </apply>
                            <ci>RI</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>RI</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kom</ci>
                            <ci>I</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>koSRCa</ci>
                            <apply>
                                <power/>
                                <ci>Ca_sub</ci>
                                <cn cellml:units="dimensionless">2</cn>
                            </apply>
                            <ci>RI</ci>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kim</ci>
                            <ci>RI</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kiSRCa</ci>
                            <ci>Ca_sub</ci>
                            <ci>R</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>P_tot</ci>
                <apply>
                    <plus/>
                    <ci>R</ci>
                    <ci>O</ci>
                    <ci>I</ci>
                    <ci>RI</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--***************SR influx Ca ion in cell compartments****************//-->
    <component name="Ca_intracellular_fluxes">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="ACh" public_interface="in" units="millimolar"/>
        <variable name="ISO" public_interface="in" units="nM"/>
        <variable name="Ca_nsr" public_interface="in" units="millimolar"/>
        <variable name="Cai" public_interface="in" units="millimolar"/>
        <variable name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable name="Ca_jsr" public_interface="in" units="millimolar"/>
        <variable name="j_Ca_dif" public_interface="out" units="millimolar_per_second"/>
        <variable name="j_up" public_interface="out" units="millimolar_per_second"/>
        <variable name="j_tr" public_interface="out" units="millimolar_per_second"/>
        <variable initial_value="5.469e-5" name="tau_dif_Ca" units="second"/>
        <variable initial_value="0.04" name="tau_tr" units="second"/>
        <variable name="P_up" units="millimolar_per_second"/>
        <variable initial_value="5" name="P_up_basal" units="millimolar_per_second"/>
        <variable name="b_up" units="dimensionless"/>
        <variable initial_value="0.000286113" name="K_up" units="millimolar"/>
        <variable initial_value="5e-5" name="slope_up" units="millimolar"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>b_up</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.25</cn>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>ISO</ci>
                            <cn cellml:units="nM">0</cn>
                        </apply>
                    </piece>
                    <piece>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">0.7</cn>
                                <ci>ACh</ci>
                            </apply>
                            <apply>
                                <plus/>
                                <cn cellml:units="millimolar">0.00009</cn>
                                <ci>ACh</ci>
                            </apply>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>ACh</ci>
                            <cn cellml:units="millimolar">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>P_up</ci>
                <apply>
                    <times/>
                    <ci>P_up_basal</ci>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>b_up</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>j_Ca_dif</ci>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>Ca_sub</ci>
                        <ci>Cai</ci>
                    </apply>
                    <ci>tau_dif_Ca</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>j_up</ci>
                <apply>
                    <divide/>
                    <ci>P_up</ci>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <apply>
                                        <minus/>
                                        <ci>Cai</ci>
                                    </apply>
                                    <ci>K_up</ci>
                                </apply>
                                <ci>slope_up</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>j_tr</ci>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>Ca_nsr</ci>
                        <ci>Ca_jsr</ci>
                    </apply>
                    <ci>tau_tr</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--***************Buffer of Ca ion in cell compartments****************//-->
    <component name="Ca_buffering">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="Cai" public_interface="in" units="millimolar"/>
        <variable name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable name="Ca_jsr" public_interface="in" units="millimolar"/>
        <variable initial_value="0.031" name="TC_tot" public_interface="out" units="millimolar"/>
        <variable initial_value="0.062" name="TMC_tot" public_interface="out" units="millimolar"/>
        <variable initial_value="0.045" name="CM_tot" public_interface="out" units="millimolar"/>
        <variable initial_value="10" name="CQ_tot" public_interface="out" units="millimolar"/>
        <variable name="delta_fTC" public_interface="out" units="per_second"/>
        <variable name="delta_fTMC" public_interface="out" units="per_second"/>
        <variable name="delta_fCMs" public_interface="out" units="per_second"/>
        <variable name="delta_fCMi" public_interface="out" units="per_second"/>
        <variable name="delta_fCQ" public_interface="out" units="per_second"/>
        <variable name="delta_fTMM" units="per_second"/>
        <variable initial_value="0.653777" name="fTMM" units="dimensionless"/>
        <variable initial_value="0.217311" name="fCMi" units="dimensionless"/>
        <variable initial_value="0.158521" name="fCMs" units="dimensionless"/>
        <variable initial_value="0.017929" name="fTC" units="dimensionless"/>
        <variable initial_value="0.259947" name="fTMC" units="dimensionless"/>
        <variable initial_value="0.138975" name="fCQ" units="dimensionless"/>
        <variable initial_value="88800" name="kf_TC" units="per_millimolar_second"/>
        <variable initial_value="2277" name="kf_TMM" units="per_millimolar_second"/>
        <variable initial_value="227700" name="kf_TMC" units="per_millimolar_second"/>
        <variable initial_value="1.642e6" name="kf_CM" units="per_millimolar_second"/>
        <variable initial_value="175.4" name="kf_CQ" units="per_millimolar_second"/>
        <variable initial_value="446" name="kb_TC" units="per_second"/>
        <variable initial_value="7.51" name="kb_TMC" units="per_second"/>
        <variable initial_value="751" name="kb_TMM" units="per_second"/>
        <variable initial_value="542" name="kb_CM" units="per_second"/>
        <variable initial_value="445" name="kb_CQ" units="per_second"/>
        <variable initial_value="2.5" name="Mgi" units="millimolar"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>fTC</ci>
                </apply>
                <ci>delta_fTC</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fTC</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_TC</ci>
                        <ci>Cai</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>fTC</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_TC</ci>
                        <ci>fTC</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>fTMC</ci>
                </apply>
                <ci>delta_fTMC</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fTMC</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_TMC</ci>
                        <ci>Cai</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <plus/>
                                <ci>fTMC</ci>
                                <ci>fTMM</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_TMC</ci>
                        <ci>fTMC</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>fTMM</ci>
                </apply>
                <ci>delta_fTMM</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fTMM</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_TMM</ci>
                        <ci>Mgi</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <plus/>
                                <ci>fTMC</ci>
                                <ci>fTMM</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_TMM</ci>
                        <ci>fTMM</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>fCMi</ci>
                </apply>
                <ci>delta_fCMi</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fCMi</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_CM</ci>
                        <ci>Cai</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>fCMi</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_CM</ci>
                        <ci>fCMi</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>fCMs</ci>
                </apply>
                <ci>delta_fCMs</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fCMs</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_CM</ci>
                        <ci>Ca_sub</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>fCMs</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_CM</ci>
                        <ci>fCMs</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>fCQ</ci>
                </apply>
                <ci>delta_fCQ</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fCQ</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_CQ</ci>
                        <ci>Ca_jsr</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>fCQ</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_CQ</ci>
                        <ci>fCQ</ci>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_f current module****************//-->
    <component name="i_f">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="Ko" public_interface="in" units="millimolar"/>
        <variable name="blockade" public_interface="in" units="dimensionless"/>
        <variable name="g_f" public_interface="in" units="microS"/>
        <variable name="Km_f" public_interface="in" units="millimolar"/>
        <variable name="alpha" public_interface="in" units="dimensionless"/>
        <variable name="E_Na" public_interface="in" units="millivolt"/>
        <variable name="E_K" public_interface="in" units="millivolt"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="y" public_interface="in" units="dimensionless"/>
        <variable name="G_f" public_interface="out" units="microS"/>
        <variable name="g_f_Na" public_interface="out" units="microS"/>
        <variable name="G_f_Na" public_interface="out" units="microS"/>
        <variable name="g_f_K" public_interface="out" units="microS"/>
        <variable name="G_f_K" public_interface="out" units="microS"/>
        <variable name="i_fK" public_interface="out" units="nanoA"/>
        <variable name="i_fNa" public_interface="out" units="nanoA"/>
        <variable name="i_f" public_interface="out" units="nanoA"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>G_f</ci>
                <apply>
                    <divide/>
                    <ci>g_f</ci>
                    <apply>
                        <divide/>
                        <ci>Ko</ci>
                        <apply>
                            <plus/>
                            <ci>Ko</ci>
                            <ci>Km_f</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>G_f_K</ci>
                <apply>
                    <divide/>
                    <ci>G_f</ci>
                    <apply>
                        <plus/>
                        <ci>alpha</ci>
                        <cn cellml:units="dimensionless">1</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>G_f_Na</ci>
                <apply>
                    <times/>
                    <ci>alpha</ci>
                    <ci>G_f_K</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>g_f_Na</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>G_f_Na</ci>
                        <ci>Ko</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>Ko</ci>
                        <ci>Km_f</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>g_f_K</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>G_f_K</ci>
                        <ci>Ko</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>Ko</ci>
                        <ci>Km_f</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_fNa</ci>
                <apply>
                    <times/>
                    <ci>y</ci>
                    <ci>g_f_Na</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_Na</ci>
                    </apply>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>blockade</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_fK</ci>
                <apply>
                    <times/>
                    <ci>y</ci>
                    <ci>g_f_K</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_K</ci>
                    </apply>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>blockade</ci>
                    </apply>
                </apply>
            </apply>
            <!--according to the definition, I_f peak position should around action potential hyperpolarization position, but in the simulation result, not match!!!
it dependence on the coefficient 'tau_y'-->
            <apply>
                <eq/>
                <ci>i_f</ci>
                <apply>
                    <plus/>
                    <ci>i_fNa</ci>
                    <ci>i_fK</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_f_y_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="y_init" public_interface="in" units="dimensionless"/>
        <!--this variable parameter preset value just temporary, and I think use this value will make the result more closely-->
        <variable name="cAMP_iter" public_interface="in" units="dimensionless"/>
        <!--var cAMP_iter: dimensionless {init: 1};
I don't know why consider y_shift-->
        <variable name="y_shift" public_interface="in" units="millivolt"/>
        <variable name="K_If" public_interface="in" units="millivolt"/>
        <variable name="K05_If" public_interface="in" units="uM"/>
        <variable name="ACh" public_interface="in" units="millimolar"/>
        <variable name="cAMP_nif" public_interface="in" units="uM"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="0" name="cAMP_out" public_interface="out" units="dimensionless"/>
        <variable name="cAMP_out2" public_interface="out" units="uM"/>
        <variable name="y_infinity" public_interface="out" units="dimensionless"/>
        <variable name="ACh_shift" public_interface="out" units="millivolt"/>
        <variable name="Iso_shift" public_interface="out" units="millivolt"/>
        <variable name="Iso_shift2" public_interface="out" units="millivolt"/>
        <variable name="tau_y" public_interface="out" units="second"/>
        <variable initial_value="y_init" name="y" public_interface="out" units="dimensionless"/>
        <!--the EC50=1.26E-8M(close), max=-7.2,nf=0.69(close) in rabbit SAN cell, based on<Analysis of the Chronotropic Effect of Acetylcholine on Sinoatrial Node Cells>-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>ACh_shift</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <minus/>
                            <apply>
                                <minus/>
                                <cn cellml:units="millivolt">1</cn>
                            </apply>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="millivolt">9.898</cn>
                                    <apply>
                                        <power/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_millimolar">1</cn>
                                            <ci>ACh</ci>
                                        </apply>
                                        <cn cellml:units="dimensionless">0.618</cn>
                                    </apply>
                                </apply>
                                <apply>
                                    <plus/>
                                    <apply>
                                        <power/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_millimolar">1</cn>
                                            <ci>ACh</ci>
                                        </apply>
                                        <cn cellml:units="dimensionless">0.618</cn>
                                    </apply>
                                    <cn cellml:units="dimensionless">0.00122423</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>ACh</ci>
                            <cn cellml:units="millimolar">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="millivolt">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>cAMP_out</ci>
                </apply>
                <cn cellml:units="per_second">1</cn>
            </apply>
            <apply>
                <eq/>
                <ci>cAMP_out2</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>cAMP_out</ci>
                        <cn cellml:units="uM">0</cn>
                    </apply>
                    <ci>cAMP_nif</ci>
                </apply>
            </apply>
            <!--Iso_shift = sel
    case Iso_1_nM > 0{dimensionless}:
        7.5{millivolt};
    otherwise:
        0{millivolt};
endsel;-->
            <!--based on Linder's paper<Sympathetic Stimulation Can Compensate for  Hypocalcaemia-Induced Bradycardia in Human and  Rabbit Sinoatrial Node Cells> table1, but not build relationship yet
n=7 (based on <Real-time relationship between PKA biochemical signal network dynamics and increased action potential firing rate in heart pacemaker cells> p6 that AP firing rate in response to ISO)
according to Fabbri model, Iso_shift_max = 7.5mV, but not find the calculation formula, so just multiple a coefficient 1.33, <An updated computational model of rabbit sinoatrial action potential to investigate the mechanisms of heart rate modulation>
need check later!!! the range is [-24.4,7.5],the original should multiple with 1.0e-6
in here, we assume that protein concentration = 1000 mg/L, so K05_If=17.33 nM-->
            <apply>
                <eq/>
                <ci>Iso_shift2</ci>
                <apply>
                    <times/>
                    <apply>
                        <minus/>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <ci>K_If</ci>
                                <apply>
                                    <power/>
                                    <apply>
                                        <times/>
                                        <cn cellml:units="per_uM">1</cn>
                                        <ci>cAMP_nif</ci>
                                    </apply>
                                    <cn cellml:units="dimensionless">1</cn>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">1.0</cn>
                                    <apply>
                                        <power/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_uM">1</cn>
                                            <ci>K05_If</ci>
                                        </apply>
                                        <cn cellml:units="dimensionless">1</cn>
                                    </apply>
                                </apply>
                                <apply>
                                    <power/>
                                    <apply>
                                        <times/>
                                        <cn cellml:units="per_uM">1</cn>
                                        <ci>cAMP_nif</ci>
                                    </apply>
                                    <cn cellml:units="dimensionless">1</cn>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="millivolt">18.76</cn>
                    </apply>
                    <cn cellml:units="dimensionless">1.33</cn>
                </apply>
            </apply>
            <!--Iso_shift = Iso_shift2;-->
            <apply>
                <eq/>
                <ci>Iso_shift</ci>
                <piecewise>
                    <piece>
                        <ci>Iso_shift2</ci>
                        <apply>
                            <gt/>
                            <ci>Iso_shift2</ci>
                            <cn cellml:units="millivolt">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="millivolt">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <!--not totally match with the paper, add ACh and ISO influence factors
from mathematic aspect, could explain that this coefficient could delay the I_f activate time-->
            <apply>
                <eq/>
                <ci>tau_y</ci>
                <apply>
                    <minus/>
                    <apply>
                        <divide/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <plus/>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="per_millivolt_second">0.36</cn>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">148.8</cn>
                                            </apply>
                                            <ci>ACh_shift</ci>
                                        </apply>
                                        <ci>Iso_shift</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_millivolt">0.066</cn>
                                            <apply>
                                                <minus/>
                                                <apply>
                                                    <minus/>
                                                    <apply>
                                                        <plus/>
                                                        <ci>V</ci>
                                                        <cn cellml:units="millivolt">148.8</cn>
                                                    </apply>
                                                    <ci>ACh_shift</ci>
                                                </apply>
                                                <ci>Iso_shift</ci>
                                            </apply>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="dimensionless">1</cn>
                                </apply>
                            </apply>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="per_millivolt_second">0.1</cn>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">87.3</cn>
                                            </apply>
                                            <ci>ACh_shift</ci>
                                        </apply>
                                        <ci>Iso_shift</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <minus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="per_millivolt">0.2</cn>
                                            </apply>
                                            <apply>
                                                <minus/>
                                                <apply>
                                                    <minus/>
                                                    <apply>
                                                        <plus/>
                                                        <ci>V</ci>
                                                        <cn cellml:units="millivolt">87.3</cn>
                                                    </apply>
                                                    <ci>ACh_shift</ci>
                                                </apply>
                                                <ci>Iso_shift</ci>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <cn cellml:units="second">0.054</cn>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>y_infinity</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">0.01329</cn>
                            <apply>
                                <divide/>
                                <cn cellml:units="dimensionless">0.99921</cn>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <divide/>
                                            <apply>
                                                <minus/>
                                                <apply>
                                                    <minus/>
                                                    <apply>
                                                        <minus/>
                                                        <apply>
                                                            <plus/>
                                                            <ci>V</ci>
                                                            <cn cellml:units="millivolt">97.134</cn>
                                                        </apply>
                                                        <ci>ACh_shift</ci>
                                                    </apply>
                                                    <ci>Iso_shift</ci>
                                                </apply>
                                                <ci>y_shift</ci>
                                            </apply>
                                            <cn cellml:units="millivolt">8.1752</cn>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <lt/>
                            <ci>V</ci>
                            <apply>
                                <minus/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="millivolt">80</cn>
                                            <ci>ACh_shift</ci>
                                        </apply>
                                        <ci>Iso_shift</ci>
                                    </apply>
                                    <ci>y_shift</ci>
                                </apply>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.0002501</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <apply>
                                                <minus/>
                                                <apply>
                                                    <minus/>
                                                    <ci>V</ci>
                                                    <ci>ACh_shift</ci>
                                                </apply>
                                                <ci>Iso_shift</ci>
                                            </apply>
                                            <ci>y_shift</ci>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">12.861</cn>
                                </apply>
                            </apply>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>y</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>y_infinity</ci>
                        <ci>y</ci>
                    </apply>
                    <ci>tau_y</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_KACh current module****************//-->
    <component name="i_KACh">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="g_KACh" public_interface="in" units="microS"/>
        <variable name="ACh" public_interface="in" units="millimolar"/>
        <variable name="E_K" public_interface="in" units="millivolt"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="a" public_interface="in" units="dimensionless"/>
        <variable name="ACh_on" public_interface="in" units="dimensionless"/>
        <variable name="i_KACh" public_interface="out" units="nanoA"/>
        <!--add a switch
this paper's i_KACh equation different: <Analysis of the Chronotropic Effect of Acetylcholine on Sinoatrial Node Cells>-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_KACh</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>ACh_on</ci>
                            <ci>g_KACh</ci>
                            <apply>
                                <minus/>
                                <ci>V</ci>
                                <ci>E_K</ci>
                            </apply>
                            <apply>
                                <plus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <plus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">20</cn>
                                        </apply>
                                        <cn cellml:units="millivolt">20</cn>
                                    </apply>
                                </apply>
                            </apply>
                            <ci>a</ci>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>ACh</ci>
                            <cn cellml:units="millimolar">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="nanoA">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
    </component>
    <component name="i_KACh_a_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="a_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="ACh" public_interface="in" units="millimolar"/>
        <variable initial_value="a_init" name="a" public_interface="out" units="dimensionless"/>
        <variable name="alpha_a" units="per_second"/>
        <variable name="beta_a" units="per_second"/>
        <variable name="a_infinity" units="dimensionless"/>
        <variable name="tau_a" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>alpha_a</ci>
                <apply>
                    <plus/>
                    <apply>
                        <divide/>
                        <apply>
                            <minus/>
                            <cn cellml:units="per_second">3.5988</cn>
                            <cn cellml:units="per_second">0.025641</cn>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <divide/>
                                <cn cellml:units="dimensionless">0.0000012155</cn>
                                <apply>
                                    <power/>
                                    <apply>
                                        <times/>
                                        <cn cellml:units="per_millimolar">1</cn>
                                        <ci>ACh</ci>
                                    </apply>
                                    <cn cellml:units="dimensionless">1.6951</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <cn cellml:units="per_second">0.025641</cn>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta_a</ci>
                <apply>
                    <times/>
                    <cn cellml:units="per_second">10</cn>
                    <apply>
                        <exp/>
                        <apply>
                            <times/>
                            <cn cellml:units="per_millivolt">0.0133</cn>
                            <apply>
                                <plus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">40</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>a_infinity</ci>
                <apply>
                    <divide/>
                    <ci>alpha_a</ci>
                    <apply>
                        <plus/>
                        <ci>alpha_a</ci>
                        <ci>beta_a</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_a</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <ci>alpha_a</ci>
                        <ci>beta_a</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>a</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>a_infinity</ci>
                        <ci>a</ci>
                    </apply>
                    <ci>tau_a</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_to current module****************//-->
    <component name="i_to">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="g_to" public_interface="in" units="microS"/>
        <variable name="E_K" public_interface="in" units="millivolt"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="q" public_interface="in" units="dimensionless"/>
        <variable name="r" public_interface="in" units="dimensionless"/>
        <variable name="i_to" public_interface="out" units="nanoA"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_to</ci>
                <apply>
                    <times/>
                    <ci>g_to</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_K</ci>
                    </apply>
                    <ci>q</ci>
                    <ci>r</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_to_q_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="q_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="q_init" name="q" public_interface="out" units="dimensionless"/>
        <variable name="q_infinity" units="dimensionless"/>
        <variable name="tau_q" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>q_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">49</cn>
                                </apply>
                                <cn cellml:units="millivolt">13</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_q</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">0.001</cn>
                    <cn cellml:units="dimensionless">0.6</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <divide/>
                            <cn cellml:units="dimensionless">65.17</cn>
                            <apply>
                                <plus/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="per_second">0.57</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="per_millivolt">0.08</cn>
                                            </apply>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">44</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="per_second">0.065</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_millivolt">0.1</cn>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">45.93</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="second">10.1</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>q</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>q_infinity</ci>
                        <ci>q</ci>
                    </apply>
                    <ci>tau_q</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_to_r_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="r_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="r_init" name="r" public_interface="out" units="dimensionless"/>
        <variable name="r_infinity" units="dimensionless"/>
        <variable name="tau_r" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>r_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">19.3</cn>
                                    </apply>
                                </apply>
                                <cn cellml:units="millivolt">15</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_r</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">0.001</cn>
                    <cn cellml:units="dimensionless">0.66</cn>
                    <cn cellml:units="dimensionless">1.4</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <divide/>
                            <cn cellml:units="second">15.59</cn>
                            <apply>
                                <plus/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">1.037</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_millivolt">0.09</cn>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">30.61</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.369</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="per_millivolt">0.12</cn>
                                            </apply>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">23.84</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="second">2.98</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>r</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>r_infinity</ci>
                        <ci>r</ci>
                    </apply>
                    <ci>tau_r</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_Na current module****************//-->
    <component name="i_Na">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="Nao" public_interface="in" units="millimolar"/>
        <variable name="Ko" public_interface="in" units="millimolar"/>
        <variable name="Ki" public_interface="in" units="millimolar"/>
        <variable name="g_Na" public_interface="in" units="microS"/>
        <variable name="g_Na_L" public_interface="in" units="microS"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="RTONF" public_interface="in" units="millivolt"/>
        <variable name="Nai" public_interface="in" units="millimolar"/>
        <variable name="m" public_interface="in" units="dimensionless"/>
        <variable name="h" public_interface="in" units="dimensionless"/>
        <variable name="i_Na" public_interface="out" units="nanoA"/>
        <variable name="i_Na_" units="nanoA"/>
        <variable name="i_Na_L" units="nanoA"/>
        <variable name="E_mh" units="millivolt"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>E_mh</ci>
                <apply>
                    <times/>
                    <ci>RTONF</ci>
                    <apply>
                        <ln/>
                        <apply>
                            <divide/>
                            <apply>
                                <plus/>
                                <ci>Nao</ci>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.12</cn>
                                    <ci>Ko</ci>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>Nai</ci>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.12</cn>
                                    <ci>Ki</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_Na_</ci>
                <apply>
                    <times/>
                    <ci>g_Na</ci>
                    <apply>
                        <power/>
                        <ci>m</ci>
                        <cn cellml:units="dimensionless">3</cn>
                    </apply>
                    <ci>h</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_mh</ci>
                    </apply>
                </apply>
            </apply>
            <!--not sure why in here add a new algorithm to calculate the i_Na, although preset 0-->
            <apply>
                <eq/>
                <ci>i_Na_L</ci>
                <apply>
                    <times/>
                    <ci>g_Na_L</ci>
                    <apply>
                        <power/>
                        <ci>m</ci>
                        <cn cellml:units="dimensionless">3</cn>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_mh</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_Na</ci>
                <apply>
                    <plus/>
                    <ci>i_Na_</ci>
                    <ci>i_Na_L</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Na_m_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="m_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="delta_m" public_interface="in" units="millivolt"/>
        <variable initial_value="m_init" name="m" public_interface="out" units="dimensionless"/>
        <variable name="alpha_m" units="per_second"/>
        <variable name="beta_m" units="per_second"/>
        <variable name="m_infinity" units="dimensionless"/>
        <variable name="tau_m" units="second"/>
        <variable name="E0_m" units="millivolt"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>m_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">42.0504</cn>
                                    </apply>
                                </apply>
                                <cn cellml:units="millivolt">8.3106</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>E0_m</ci>
                <apply>
                    <plus/>
                    <ci>V</ci>
                    <cn cellml:units="millivolt">41</cn>
                </apply>
            </apply>
            <!--if the voltage too small, use preset parameter-->
            <apply>
                <eq/>
                <ci>alpha_m</ci>
                <piecewise>
                    <piece>
                        <cn cellml:units="per_second">2000</cn>
                        <apply>
                            <lt/>
                            <apply>
                                <abs/>
                                <ci>E0_m</ci>
                            </apply>
                            <ci>delta_m</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <cn cellml:units="per_millivolt_second">200</cn>
                                <ci>E0_m</ci>
                            </apply>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="per_millivolt">0.1</cn>
                                        </apply>
                                        <ci>E0_m</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>beta_m</ci>
                <apply>
                    <times/>
                    <cn cellml:units="per_second">8000</cn>
                    <apply>
                        <exp/>
                        <apply>
                            <times/>
                            <apply>
                                <minus/>
                                <cn cellml:units="per_millivolt">0.056</cn>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">66</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_m</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <ci>alpha_m</ci>
                        <ci>beta_m</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>m</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>m_infinity</ci>
                        <ci>m</ci>
                    </apply>
                    <ci>tau_m</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Na_h_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="h_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="h_init" name="h" public_interface="out" units="dimensionless"/>
        <variable name="alpha_h" units="per_second"/>
        <variable name="beta_h" units="per_second"/>
        <variable name="h_infinity" units="dimensionless"/>
        <variable name="tau_h" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>h_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">69.804</cn>
                                </apply>
                                <cn cellml:units="millivolt">4.4565</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>alpha_h</ci>
                <apply>
                    <times/>
                    <cn cellml:units="per_second">20</cn>
                    <apply>
                        <exp/>
                        <apply>
                            <times/>
                            <apply>
                                <minus/>
                                <cn cellml:units="per_millivolt">0.125</cn>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">75</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta_h</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="per_second">2000</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">320</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <times/>
                                    <apply>
                                        <minus/>
                                        <cn cellml:units="per_millivolt">0.1</cn>
                                    </apply>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">75</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="dimensionless">1</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_h</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <ci>alpha_h</ci>
                        <ci>beta_h</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>h</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>h_infinity</ci>
                        <ci>h</ci>
                    </apply>
                    <ci>tau_h</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_CaL current module****************//-->
    <component name="i_CaL">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="Nao" public_interface="in" units="millimolar"/>
        <variable name="Ko" public_interface="in" units="millimolar"/>
        <variable name="Ki" public_interface="in" units="millimolar"/>
        <variable name="Cao" public_interface="in" units="millimolar"/>
        <variable name="P_CaL" public_interface="in" units="nanoA_per_millimolar"/>
        <variable name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable name="Nai" public_interface="in" units="millimolar"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="RTONF" public_interface="in" units="millivolt"/>
        <variable name="PKA_new" public_interface="in" units="dimensionless"/>
        <variable name="ACh" public_interface="in" units="millimolar"/>
        <variable name="dL" public_interface="in" units="dimensionless"/>
        <variable name="fL" public_interface="in" units="dimensionless"/>
        <variable name="fCa" public_interface="in" units="dimensionless"/>
        <variable name="i_CaL" public_interface="out" units="nanoA"/>
        <variable name="i_siCa" public_interface="out" units="nanoA"/>
        <variable name="i_siNa" public_interface="out" units="nanoA"/>
        <variable name="i_siK" units="nanoA"/>
        <variable name="ACh_block" units="dimensionless"/>
        <variable name="Iso_increase" units="dimensionless"/>
        <variable name="Iso_increase2" units="dimensionless"/>
        <!--var ISO: nM {pub: in};-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Iso_increase2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.2152</cn>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.4707</cn>
                            <apply>
                                <power/>
                                <ci>PKA_new</ci>
                                <cn cellml:units="dimensionless">10.0808</cn>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <cn cellml:units="dimensionless">0.7303</cn>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>PKA_new</ci>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Iso_increase</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <plus/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">1</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <!--3 formulas are match with the paper-->
            <apply>
                <eq/>
                <ci>i_siCa</ci>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">2</cn>
                            <ci>P_CaL</ci>
                            <apply>
                                <minus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">0</cn>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <ci>RTONF</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="dimensionless">1</cn>
                                            </apply>
                                            <apply>
                                                <minus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">0</cn>
                                            </apply>
                                            <cn cellml:units="dimensionless">2</cn>
                                        </apply>
                                        <ci>RTONF</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>Ca_sub</ci>
                        <apply>
                            <times/>
                            <ci>Cao</ci>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="dimensionless">2</cn>
                                        </apply>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">0</cn>
                                        </apply>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>dL</ci>
                    <ci>fL</ci>
                    <ci>fCa</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_siK</ci>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.000365</cn>
                            <ci>P_CaL</ci>
                            <apply>
                                <minus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">0</cn>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <ci>RTONF</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="dimensionless">1</cn>
                                            </apply>
                                            <apply>
                                                <minus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">0</cn>
                                            </apply>
                                        </apply>
                                        <ci>RTONF</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>Ki</ci>
                        <apply>
                            <times/>
                            <ci>Ko</ci>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="dimensionless">1</cn>
                                        </apply>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">0</cn>
                                        </apply>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>dL</ci>
                    <ci>fL</ci>
                    <ci>fCa</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_siNa</ci>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.0000185</cn>
                            <ci>P_CaL</ci>
                            <apply>
                                <minus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">0</cn>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <ci>RTONF</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="dimensionless">1</cn>
                                            </apply>
                                            <apply>
                                                <minus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">0</cn>
                                            </apply>
                                        </apply>
                                        <ci>RTONF</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>Nai</ci>
                        <apply>
                            <times/>
                            <ci>Nao</ci>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="dimensionless">1</cn>
                                        </apply>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">0</cn>
                                        </apply>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>dL</ci>
                    <ci>fL</ci>
                    <ci>fCa</ci>
                </apply>
            </apply>
            <!--in here, also add a block coefficient
the EC50=9E-8M(same), max=0.56 in rabbit SAN cell, based on<Analysis of the Chronotropic Effect of Acetylcholine on Sinoatrial Node Cells>-->
            <apply>
                <eq/>
                <ci>ACh_block</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <cn cellml:units="dimensionless">0.31</cn>
                        <ci>ACh</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>ACh</ci>
                        <cn cellml:units="millimolar">0.00009</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_CaL</ci>
                <apply>
                    <times/>
                    <apply>
                        <plus/>
                        <ci>i_siCa</ci>
                        <ci>i_siK</ci>
                        <ci>i_siNa</ci>
                    </apply>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>ACh_block</ci>
                    </apply>
                    <cn cellml:units="dimensionless">1</cn>
                    <ci>Iso_increase</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_CaL_dL_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="dL_init" public_interface="in" units="dimensionless"/>
        <variable name="k_dL" public_interface="in" units="millivolt"/>
        <variable name="V_dL" public_interface="in" units="millivolt"/>
        <!--add new equation about Iso_shift/Iso_slope that control by PKA, b-AR -> AC -> cAMP -> PKA-->
        <variable name="PKA_new" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <!--var ISO: nM {pub: in};-->
        <variable initial_value="dL_init" name="dL" public_interface="out" units="dimensionless"/>
        <variable name="Iso_shift_dL2" units="millivolt"/>
        <variable name="Iso_slope_dL2" units="dimensionless"/>
        <variable name="Iso_shift_dL" units="millivolt"/>
        <variable name="Iso_slope_dL" units="dimensionless"/>
        <variable name="dL_infinity" units="dimensionless"/>
        <variable name="tau_dL" units="second"/>
        <variable name="alpha_dL" units="per_second"/>
        <variable name="beta_dL" units="per_second"/>
        <variable name="adVm" units="millivolt"/>
        <variable name="bdVm" units="millivolt"/>
        <!--those are original formula by Fabbri fitting-->
        <!--Iso_shift_dL = sel
    case Iso_1_nM > 0{dimensionless}:
        -8{millivolt};
    otherwise:
        0{millivolt};
endsel;-->
        <!--Iso_slope_dL = sel
   case Iso_1_nM > 0{dimensionless}:
     -27{dimensionless};
   otherwise:
        0{dimensionless};
endsel;-->
        <!--add new equation about Iso_shift/Iso_slope that control by PKA, b-AR -> AC -> cAMP -> PKA, from Linder's paper table2
the Iso_shift_dL2 range is [18.76,-8.14], the Iso_slope_dL2 range is [0.657,0.935]
calibrated by original formula, the Iso_shift_dL should not be positive value-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Iso_shift_dL2</ci>
                <apply>
                    <times/>
                    <apply>
                        <minus/>
                        <cn cellml:units="millivolt">1</cn>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">27.5262</cn>
                                <apply>
                                    <power/>
                                    <ci>PKA_new</ci>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <apply>
                                    <power/>
                                    <cn cellml:units="dimensionless">0.6615</cn>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                                <apply>
                                    <power/>
                                    <ci>PKA_new</ci>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="dimensionless">18.76</cn>
                    </apply>
                </apply>
            </apply>
            <!--if directly use Iso_shift_dL2, need Iso>0.095 that activate the Iso_shift_dL2 make it lower than 0
Iso_shift_dL = Iso_shift_dL2;-->
            <apply>
                <eq/>
                <ci>Iso_shift_dL</ci>
                <piecewise>
                    <piece>
                        <cn cellml:units="millivolt">0</cn>
                        <apply>
                            <gt/>
                            <ci>Iso_shift_dL2</ci>
                            <cn cellml:units="millivolt">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>Iso_shift_dL2</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <!--I don't know why substract 17 then the results of I_CaL are similar with original results while set Iso=0.1!!!
based on the PKA range is [0.0296,0.9922], so the Iso_slope_dL2 range is [2.0782,0.6572]
maybe the key is make Iso_slope_dL2 lower than 1(the I_CaL activated only Iso>0.95, that while PKA>0.76, then make Iso_slope_dL2<1)-->
            <apply>
                <eq/>
                <ci>Iso_slope_dL2</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1.4762</cn>
                        </apply>
                        <ci>PKA_new</ci>
                    </apply>
                    <cn cellml:units="dimensionless">2.1219</cn>
                </apply>
            </apply>
            <!--increase the constant value could make the cycle more longer, but sometimes Iso=0 CANNOT active the current
Iso_slope_dL = Iso_slope_dL2 - 0.0{dimensionless};-->
            <apply>
                <eq/>
                <ci>Iso_slope_dL</ci>
                <cn cellml:units="dimensionless">0</cn>
            </apply>
            <!--this formula is different from paper-->
            <apply>
                <eq/>
                <ci>dL_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                            <ci>V_dL</ci>
                                        </apply>
                                        <ci>Iso_shift_dL</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <ci>k_dL</ci>
                                    <apply>
                                        <plus/>
                                        <cn cellml:units="dimensionless">1</cn>
                                        <apply>
                                            <divide/>
                                            <ci>Iso_slope_dL</ci>
                                            <cn cellml:units="dimensionless">100</cn>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--below 2 formulas are match with paper-->
            <apply>
                <eq/>
                <ci>tau_dL</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">0.001</cn>
                    <apply>
                        <plus/>
                        <ci>alpha_dL</ci>
                        <ci>beta_dL</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>alpha_dL</ci>
                <apply>
                    <minus/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <apply>
                                <minus/>
                                <cn cellml:units="per_millivolt_second">0.02839</cn>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>adVm</ci>
                                <cn cellml:units="millivolt">41.8</cn>
                            </apply>
                        </apply>
                        <apply>
                            <minus/>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <plus/>
                                            <ci>adVm</ci>
                                            <cn cellml:units="millivolt">41.8</cn>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">2.5</cn>
                                </apply>
                            </apply>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="per_millivolt_second">0.0849</cn>
                            <apply>
                                <plus/>
                                <ci>adVm</ci>
                                <cn cellml:units="millivolt">6.8</cn>
                            </apply>
                        </apply>
                        <apply>
                            <minus/>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <plus/>
                                            <ci>adVm</ci>
                                            <cn cellml:units="millivolt">6.8</cn>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">4.8</cn>
                                </apply>
                            </apply>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--I don't know why add this switch formula-->
            <apply>
                <eq/>
                <ci>adVm</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <minus/>
                            <cn cellml:units="millivolt">41.80001</cn>
                        </apply>
                        <apply>
                            <eq/>
                            <ci>V</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="millivolt">41.8</cn>
                            </apply>
                        </apply>
                    </piece>
                    <piece>
                        <cn cellml:units="millivolt">0</cn>
                        <apply>
                            <eq/>
                            <ci>V</ci>
                            <cn cellml:units="millivolt">0</cn>
                        </apply>
                    </piece>
                    <piece>
                        <apply>
                            <minus/>
                            <cn cellml:units="millivolt">6.80001</cn>
                        </apply>
                        <apply>
                            <eq/>
                            <ci>V</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="millivolt">6.8</cn>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>V</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>beta_dL</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <cn cellml:units="per_millivolt_second">0.01143</cn>
                        <apply>
                            <plus/>
                            <ci>bdVm</ci>
                            <cn cellml:units="millivolt">1.8</cn>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>bdVm</ci>
                                    <cn cellml:units="millivolt">1.8</cn>
                                </apply>
                                <cn cellml:units="millivolt">2.5</cn>
                            </apply>
                        </apply>
                        <cn cellml:units="dimensionless">1</cn>
                    </apply>
                </apply>
            </apply>
            <!--same question, looks like it doesn't need-->
            <apply>
                <eq/>
                <ci>bdVm</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <minus/>
                            <cn cellml:units="millivolt">1.80001</cn>
                        </apply>
                        <apply>
                            <eq/>
                            <ci>V</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="millivolt">1.8</cn>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>V</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>dL</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>dL_infinity</ci>
                        <ci>dL</ci>
                    </apply>
                    <ci>tau_dL</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_CaL_fL_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="fL_init" public_interface="in" units="dimensionless"/>
        <variable name="k_fL" public_interface="in" units="millivolt"/>
        <variable name="shift_fL" public_interface="in" units="millivolt"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="fL_init" name="fL" public_interface="out" units="dimensionless"/>
        <variable name="fL_infinity" units="dimensionless"/>
        <variable name="tau_fL" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>fL_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">37.4</cn>
                                    <ci>shift_fL</ci>
                                </apply>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="millivolt">5.3</cn>
                                    <ci>k_fL</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_fL</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">0.001</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="second">44.3</cn>
                        <apply>
                            <times/>
                            <cn cellml:units="second">230</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <power/>
                                        <apply>
                                            <divide/>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">36</cn>
                                            </apply>
                                            <cn cellml:units="millivolt">10</cn>
                                        </apply>
                                        <cn cellml:units="dimensionless">2</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>fL</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>fL_infinity</ci>
                        <ci>fL</ci>
                    </apply>
                    <ci>tau_fL</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_CaL_fCa_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="fCa_init" public_interface="in" units="dimensionless"/>
        <variable name="alpha_fCa" public_interface="in" units="per_second"/>
        <variable name="Km_fCa" public_interface="in" units="millimolar"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable initial_value="fCa_init" name="fCa" public_interface="out" units="dimensionless"/>
        <variable name="fCa_infinity" units="dimensionless"/>
        <variable name="tau_fCa" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>fCa_infinity</ci>
                <apply>
                    <divide/>
                    <ci>Km_fCa</ci>
                    <apply>
                        <plus/>
                        <ci>Km_fCa</ci>
                        <ci>Ca_sub</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_fCa</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <cn cellml:units="dimensionless">0.001</cn>
                        <ci>fCa_infinity</ci>
                    </apply>
                    <ci>alpha_fCa</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>fCa</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>fCa_infinity</ci>
                        <ci>fCa</ci>
                    </apply>
                    <ci>tau_fCa</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_NaK current module****************//-->
    <component name="i_NaK">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="Ko" public_interface="in" units="millimolar"/>
        <variable name="Km_Kp" public_interface="in" units="millimolar"/>
        <variable name="Km_Nap" public_interface="in" units="millimolar"/>
        <variable name="i_NaK_max" public_interface="in" units="nanoA"/>
        <variable name="Nai" public_interface="in" units="millimolar"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="E_Na" public_interface="in" units="millivolt"/>
        <variable name="PKA_new" public_interface="in" units="dimensionless"/>
        <variable name="i_NaK" public_interface="out" units="nanoA"/>
        <variable name="Iso_increase" units="dimensionless"/>
        <variable name="Iso_increase2" units="dimensionless"/>
        <!--the Iso_increase2 range is [-7.38,0.20]-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Iso_increase2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.2152</cn>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.4357</cn>
                            <apply>
                                <power/>
                                <ci>PKA_new</ci>
                                <cn cellml:units="dimensionless">10.0808</cn>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <cn cellml:units="dimensionless">0.7042</cn>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>PKA_new</ci>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Iso_increase</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <plus/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">1.0</cn>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">1</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <!--add a enhanced coefficient
original Fabbri fitting
Iso_increase = sel
    case Iso_1_nM > 0{dimensionless}:
        1.2{dimensionless};
    otherwise:
        1{dimensionless};
endsel;-->
            <apply>
                <eq/>
                <ci>i_NaK</ci>
                <apply>
                    <times/>
                    <ci>Iso_increase</ci>
                    <ci>i_NaK_max</ci>
                    <apply>
                        <power/>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <power/>
                                <apply>
                                    <divide/>
                                    <ci>Km_Kp</ci>
                                    <ci>Ko</ci>
                                </apply>
                                <cn cellml:units="dimensionless">1.2</cn>
                            </apply>
                        </apply>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <power/>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <power/>
                                <apply>
                                    <divide/>
                                    <ci>Km_Nap</ci>
                                    <ci>Nai</ci>
                                </apply>
                                <cn cellml:units="dimensionless">1.3</cn>
                            </apply>
                        </apply>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <power/>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <plus/>
                                            <apply>
                                                <minus/>
                                                <ci>V</ci>
                                                <ci>E_Na</ci>
                                            </apply>
                                            <cn cellml:units="millivolt">110</cn>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">20</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_NaCa current module****************//-->
    <component name="i_NaCa">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="Cao" public_interface="in" units="millimolar"/>
        <variable name="Nao" public_interface="in" units="millimolar"/>
        <variable name="K_NaCa" public_interface="in" units="nanoA"/>
        <variable name="Qci" public_interface="in" units="dimensionless"/>
        <variable name="Qn" public_interface="in" units="dimensionless"/>
        <variable name="Qco" public_interface="in" units="dimensionless"/>
        <variable name="K3ni" public_interface="in" units="millimolar"/>
        <variable name="Kci" public_interface="in" units="millimolar"/>
        <variable name="K1ni" public_interface="in" units="millimolar"/>
        <variable name="K2ni" public_interface="in" units="millimolar"/>
        <variable name="Kcni" public_interface="in" units="millimolar"/>
        <variable name="K3no" public_interface="in" units="millimolar"/>
        <variable name="K1no" public_interface="in" units="millimolar"/>
        <variable name="K2no" public_interface="in" units="millimolar"/>
        <variable name="Kco" public_interface="in" units="millimolar"/>
        <variable name="blockade_NaCa" public_interface="in" units="dimensionless"/>
        <variable name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable name="Nai" public_interface="in" units="millimolar"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="RTONF" public_interface="in" units="millivolt"/>
        <variable name="i_NaCa" public_interface="out" units="nanoA"/>
        <variable name="x1" units="dimensionless"/>
        <variable name="x2" units="dimensionless"/>
        <variable name="x3" units="dimensionless"/>
        <variable name="x4" units="dimensionless"/>
        <variable name="k41" units="dimensionless"/>
        <variable name="k34" units="dimensionless"/>
        <variable name="k23" units="dimensionless"/>
        <variable name="k21" units="dimensionless"/>
        <variable name="k32" units="dimensionless"/>
        <variable name="k43" units="dimensionless"/>
        <variable name="k12" units="dimensionless"/>
        <variable name="k14" units="dimensionless"/>
        <variable name="do" units="dimensionless"/>
        <variable name="di" units="dimensionless"/>
        <!--add a blockade coefficient about Na-Ca pump-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_NaCa</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>blockade_NaCa</ci>
                        </apply>
                        <ci>K_NaCa</ci>
                        <apply>
                            <minus/>
                            <apply>
                                <times/>
                                <ci>x2</ci>
                                <ci>k21</ci>
                            </apply>
                            <apply>
                                <times/>
                                <ci>x1</ci>
                                <ci>k12</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>x1</ci>
                        <ci>x2</ci>
                        <ci>x3</ci>
                        <ci>x4</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>x1</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>k41</ci>
                        <ci>k34</ci>
                        <apply>
                            <plus/>
                            <ci>k23</ci>
                            <ci>k21</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k21</ci>
                        <ci>k32</ci>
                        <apply>
                            <plus/>
                            <ci>k43</ci>
                            <ci>k41</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>x2</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>k32</ci>
                        <ci>k43</ci>
                        <apply>
                            <plus/>
                            <ci>k14</ci>
                            <ci>k12</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k41</ci>
                        <ci>k12</ci>
                        <apply>
                            <plus/>
                            <ci>k34</ci>
                            <ci>k32</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>x3</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>k14</ci>
                        <ci>k43</ci>
                        <apply>
                            <plus/>
                            <ci>k23</ci>
                            <ci>k21</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k12</ci>
                        <ci>k23</ci>
                        <apply>
                            <plus/>
                            <ci>k43</ci>
                            <ci>k41</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>x4</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>k23</ci>
                        <ci>k34</ci>
                        <apply>
                            <plus/>
                            <ci>k14</ci>
                            <ci>k12</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k14</ci>
                        <ci>k21</ci>
                        <apply>
                            <plus/>
                            <ci>k34</ci>
                            <ci>k32</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k43</ci>
                <apply>
                    <divide/>
                    <ci>Nai</ci>
                    <apply>
                        <plus/>
                        <ci>K3ni</ci>
                        <ci>Nai</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k12</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Ca_sub</ci>
                            <ci>Kci</ci>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <apply>
                                        <minus/>
                                        <ci>Qci</ci>
                                    </apply>
                                    <ci>V</ci>
                                </apply>
                                <ci>RTONF</ci>
                            </apply>
                        </apply>
                    </apply>
                    <ci>di</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k14</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <apply>
                                    <divide/>
                                    <ci>Nai</ci>
                                    <ci>K1ni</ci>
                                </apply>
                                <ci>Nai</ci>
                            </apply>
                            <ci>K2ni</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <divide/>
                                <ci>Nai</ci>
                                <ci>K3ni</ci>
                            </apply>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <ci>Qn</ci>
                                    <ci>V</ci>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">2</cn>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>di</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k41</ci>
                <apply>
                    <exp/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <apply>
                                <minus/>
                                <ci>Qn</ci>
                            </apply>
                            <ci>V</ci>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">2</cn>
                            <ci>RTONF</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>di</ci>
                <apply>
                    <plus/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Ca_sub</ci>
                            <ci>Kci</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <ci>Qci</ci>
                                        </apply>
                                        <ci>V</ci>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                            <apply>
                                <divide/>
                                <ci>Nai</ci>
                                <ci>Kcni</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Nai</ci>
                            <ci>K1ni</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <times/>
                                <apply>
                                    <divide/>
                                    <ci>Nai</ci>
                                    <ci>K2ni</ci>
                                </apply>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <divide/>
                                        <ci>Nai</ci>
                                        <ci>K3ni</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k34</ci>
                <apply>
                    <divide/>
                    <ci>Nao</ci>
                    <apply>
                        <plus/>
                        <ci>K3no</ci>
                        <ci>Nao</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k21</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Cao</ci>
                            <ci>Kco</ci>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <ci>Qco</ci>
                                    <ci>V</ci>
                                </apply>
                                <ci>RTONF</ci>
                            </apply>
                        </apply>
                    </apply>
                    <ci>do</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k23</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <apply>
                                    <divide/>
                                    <ci>Nao</ci>
                                    <ci>K1no</ci>
                                </apply>
                                <ci>Nao</ci>
                            </apply>
                            <ci>K2no</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <divide/>
                                <ci>Nao</ci>
                                <ci>K3no</ci>
                            </apply>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <apply>
                                        <minus/>
                                        <ci>Qn</ci>
                                    </apply>
                                    <ci>V</ci>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">2</cn>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>do</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k32</ci>
                <apply>
                    <exp/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <ci>Qn</ci>
                            <ci>V</ci>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">2</cn>
                            <ci>RTONF</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>do</ci>
                <apply>
                    <plus/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Cao</ci>
                            <ci>Kco</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <ci>Qco</ci>
                                        <ci>V</ci>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Nao</ci>
                            <ci>K1no</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <times/>
                                <apply>
                                    <divide/>
                                    <ci>Nao</ci>
                                    <ci>K2no</ci>
                                </apply>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <divide/>
                                        <ci>Nao</ci>
                                        <ci>K3no</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_Kur current module****************//-->
    <component name="i_Kur">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="g_Kur" public_interface="in" units="microS"/>
        <variable name="r_Kur" public_interface="in" units="dimensionless"/>
        <variable name="s_Kur" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="E_K" public_interface="in" units="millivolt"/>
        <variable name="i_Kur" public_interface="out" units="nanoA"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_Kur</ci>
                <apply>
                    <times/>
                    <ci>g_Kur</ci>
                    <ci>r_Kur</ci>
                    <ci>s_Kur</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_K</ci>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Kur_rKur_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="r_Kur_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="r_Kur_init" name="r_Kur" public_interface="out" units="dimensionless"/>
        <variable name="tau_r_Kur" units="second"/>
        <variable name="r_Kur_infinity" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>r_Kur</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>r_Kur_infinity</ci>
                        <ci>r_Kur</ci>
                    </apply>
                    <ci>tau_r_Kur</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>r_Kur_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">6</cn>
                                </apply>
                                <apply>
                                    <minus/>
                                    <cn cellml:units="millivolt">8.6</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_r_Kur</ci>
                <apply>
                    <plus/>
                    <apply>
                        <divide/>
                        <cn cellml:units="second">0.009</cn>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">5</cn>
                                    </apply>
                                    <cn cellml:units="millivolt">12</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <cn cellml:units="second">0.0005</cn>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Kur_sKur_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="s_Kur_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="s_Kur_init" name="s_Kur" public_interface="out" units="dimensionless"/>
        <variable name="tau_s_Kur" units="second"/>
        <variable name="s_Kur_infinity" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>s_Kur</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>s_Kur_infinity</ci>
                        <ci>s_Kur</ci>
                    </apply>
                    <ci>tau_s_Kur</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>s_Kur_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">7.5</cn>
                                </apply>
                                <cn cellml:units="millivolt">10</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_s_Kur</ci>
                <apply>
                    <plus/>
                    <apply>
                        <divide/>
                        <cn cellml:units="second">0.59</cn>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">60</cn>
                                    </apply>
                                    <cn cellml:units="millivolt">10</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <cn cellml:units="second">3.05</cn>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_Ks current module****************//-->
    <component name="i_Ks">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="Ki" public_interface="in" units="millimolar"/>
        <variable name="Ko" public_interface="in" units="millimolar"/>
        <variable name="Nao" public_interface="in" units="millimolar"/>
        <!--var g_Ks_: microS {pub: in};-->
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="Nai" public_interface="in" units="millimolar"/>
        <variable name="RTONF" public_interface="in" units="millivolt"/>
        <variable name="ISO" public_interface="in" units="nM"/>
        <variable name="PKA_new" public_interface="in" units="dimensionless"/>
        <variable name="n" public_interface="in" units="dimensionless"/>
        <variable name="i_Ks" public_interface="out" units="nanoA"/>
        <variable name="Iso_increase2" units="dimensionless"/>
        <variable name="Iso_increase" units="dimensionless"/>
        <variable name="g_Ks" units="microS"/>
        <variable initial_value="0.00065" name="g_Ks_" units="microS"/>
        <variable name="E_Ks" units="millivolt"/>
        <!--define Iso_increase value
from this article <Isoprenaline: A Potential Contributor in Sick Sinus SyndromeInsights from a Mathematical Model of the Rabbit Sinoatrial Node>, the result current should be new_I_ks=old_I_ks*(1+Iso_increase)
the Iso_increase2 range is [-7.38,0.20]
Iso_increase = Iso_increase2+1{dimensionless};-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Iso_increase2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.2152</cn>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.4357</cn>
                            <apply>
                                <power/>
                                <ci>PKA_new</ci>
                                <cn cellml:units="dimensionless">10.0808</cn>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <cn cellml:units="dimensionless">0.7042</cn>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>PKA_new</ci>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Iso_increase</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <plus/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">1</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <!--add a switch coefficient that shift the voltage value, I think it will make this channel current shift-->
            <apply>
                <eq/>
                <ci>g_Ks</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>Iso_increase</ci>
                            <ci>g_Ks_</ci>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>ISO</ci>
                            <cn cellml:units="nM">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>g_Ks_</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>E_Ks</ci>
                <apply>
                    <times/>
                    <ci>RTONF</ci>
                    <apply>
                        <ln/>
                        <apply>
                            <divide/>
                            <apply>
                                <plus/>
                                <ci>Ko</ci>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.12</cn>
                                    <ci>Nao</ci>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>Ki</ci>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.12</cn>
                                    <ci>Nai</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_Ks</ci>
                <apply>
                    <times/>
                    <ci>g_Ks</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_Ks</ci>
                    </apply>
                    <apply>
                        <power/>
                        <ci>n</ci>
                        <cn cellml:units="dimensionless">2</cn>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Ks_n_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="n_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="PKA_new" public_interface="in" units="dimensionless"/>
        <variable initial_value="n_init" name="n" public_interface="out" units="dimensionless"/>
        <variable name="Iso_shift" units="millivolt"/>
        <variable name="alpha_n" units="per_second"/>
        <variable name="beta_n" units="per_second"/>
        <variable name="Iso_shift2" units="millivolt"/>
        <variable name="n_infinity" units="dimensionless"/>
        <variable name="tau_n" units="second"/>
        <!--add new equation about Iso_shift that control by PKA, b-AR -> AC -> cAMP -> PKA, from Linder's paper table3
the Iso_shift2 range is [18.76,-14.3]
the same as I_CaL and I_f, usually need Iso_shift2 lower than 0-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Iso_shift2</ci>
                <apply>
                    <times/>
                    <apply>
                        <minus/>
                        <cn cellml:units="millivolt">1</cn>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">34.4376</cn>
                                <apply>
                                    <power/>
                                    <ci>PKA_new</ci>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <apply>
                                    <power/>
                                    <cn cellml:units="dimensionless">0.7042</cn>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                                <apply>
                                    <power/>
                                    <ci>PKA_new</ci>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="dimensionless">18.76</cn>
                    </apply>
                </apply>
            </apply>
            <!--Iso_shift = Iso_shift2;-->
            <apply>
                <eq/>
                <ci>Iso_shift</ci>
                <piecewise>
                    <piece>
                        <cn cellml:units="millivolt">0</cn>
                        <apply>
                            <gt/>
                            <ci>Iso_shift2</ci>
                            <cn cellml:units="millivolt">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>Iso_shift2</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <!--original Fabbri fitting-->
            <!--Iso_shift = sel
    case Iso_1_nM > 0{dimensionless}:
        -14{millivolt};
    otherwise:
        0{millivolt};
endsel;-->
            <apply>
                <eq/>
                <ci>n_infinity</ci>
                <apply>
                    <root/>
                    <apply>
                        <divide/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">0.6383</cn>
                                            </apply>
                                            <ci>Iso_shift</ci>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">10.7071</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_n</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <ci>alpha_n</ci>
                        <ci>beta_n</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>alpha_n</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="per_second">28</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">40</cn>
                                        </apply>
                                        <ci>Iso_shift</ci>
                                    </apply>
                                </apply>
                                <cn cellml:units="millivolt">3</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta_n</ci>
                <apply>
                    <times/>
                    <cn cellml:units="per_second">1</cn>
                    <apply>
                        <exp/>
                        <apply>
                            <divide/>
                            <apply>
                                <minus/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <ci>V</ci>
                                        <ci>Iso_shift</ci>
                                    </apply>
                                    <cn cellml:units="millivolt">5</cn>
                                </apply>
                            </apply>
                            <cn cellml:units="millivolt">25</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>n</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>n_infinity</ci>
                        <ci>n</ci>
                    </apply>
                    <ci>tau_n</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_Kr current module****************//-->
    <component name="i_Kr">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="g_Kr" public_interface="in" units="microS"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="E_K" public_interface="in" units="millivolt"/>
        <variable name="paS" public_interface="in" units="dimensionless"/>
        <variable name="paF" public_interface="in" units="dimensionless"/>
        <variable name="piy" public_interface="in" units="dimensionless"/>
        <variable name="i_Kr" public_interface="out" units="nanoA"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_Kr</ci>
                <apply>
                    <times/>
                    <ci>g_Kr</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_K</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.9</cn>
                            <ci>paF</ci>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.1</cn>
                            <ci>paS</ci>
                        </apply>
                    </apply>
                    <ci>piy</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Kr_pa_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="paS_init" public_interface="in" units="dimensionless"/>
        <variable name="paF_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="paS_init" name="paS" public_interface="out" units="dimensionless"/>
        <variable initial_value="paF_init" name="paF" public_interface="out" units="dimensionless"/>
        <variable name="pa_infinity" units="dimensionless"/>
        <variable name="alfapaF" units="per_second"/>
        <variable name="betapaF" units="per_second"/>
        <variable name="tau_paS" units="second"/>
        <variable name="tau_paF" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>alfapaF</ci>
                <apply>
                    <divide/>
                    <apply>
                        <divide/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <plus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">23.2</cn>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">6.6</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <divide/>
                        <cn cellml:units="second">0.84655354</cn>
                        <apply>
                            <plus/>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">37.2</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">11.9</cn>
                                    </apply>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">0.96</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                        </apply>
                                        <cn cellml:units="millivolt">18.5</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>betapaF</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">4</cn>
                    <apply>
                        <minus/>
                        <apply>
                            <divide/>
                            <apply>
                                <plus/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">37.2</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <divide/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">15.9</cn>
                                        </apply>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.96</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <divide/>
                                            <apply>
                                                <minus/>
                                                <ci>V</ci>
                                            </apply>
                                            <cn cellml:units="millivolt">22.5</cn>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                            <cn cellml:units="second">0.84655354</cn>
                        </apply>
                        <apply>
                            <divide/>
                            <apply>
                                <divide/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <divide/>
                                            <apply>
                                                <minus/>
                                                <apply>
                                                    <plus/>
                                                    <ci>V</ci>
                                                    <cn cellml:units="millivolt">23.2</cn>
                                                </apply>
                                            </apply>
                                            <cn cellml:units="millivolt">10.6</cn>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                            <apply>
                                <divide/>
                                <cn cellml:units="second">0.84655354</cn>
                                <apply>
                                    <plus/>
                                    <apply>
                                        <times/>
                                        <cn cellml:units="dimensionless">37.2</cn>
                                        <apply>
                                            <exp/>
                                            <apply>
                                                <divide/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">15.9</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                    <apply>
                                        <times/>
                                        <cn cellml:units="dimensionless">0.96</cn>
                                        <apply>
                                            <exp/>
                                            <apply>
                                                <divide/>
                                                <apply>
                                                    <minus/>
                                                    <ci>V</ci>
                                                </apply>
                                                <cn cellml:units="millivolt">22.5</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--below all the same as the paper-->
            <apply>
                <eq/>
                <ci>pa_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">10.0144</cn>
                                    </apply>
                                </apply>
                                <cn cellml:units="millivolt">7.6607</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_paS</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="second">0.84655354</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">4.2</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">17</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.15</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <ci>V</ci>
                                    </apply>
                                    <cn cellml:units="millivolt">21.6</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_paF</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="second">1</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">30</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">10</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <ci>V</ci>
                                </apply>
                                <cn cellml:units="millivolt">12</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>paS</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>pa_infinity</ci>
                        <ci>paS</ci>
                    </apply>
                    <ci>tau_paS</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>paF</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>pa_infinity</ci>
                        <ci>paF</ci>
                    </apply>
                    <ci>tau_paF</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Kr_pi_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="piy_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="piy_init" name="piy" public_interface="out" units="dimensionless"/>
        <variable name="pi_infinity" units="dimensionless"/>
        <variable name="tau_pi" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>tau_pi</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="second">1</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">100</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <ci>V</ci>
                                    </apply>
                                    <cn cellml:units="millivolt">54.645</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">656</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">106.157</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>pi_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">28.6</cn>
                                </apply>
                                <cn cellml:units="millivolt">17.1</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>piy</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>pi_infinity</ci>
                        <ci>piy</ci>
                    </apply>
                    <ci>tau_pi</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************I_CaT current module****************//-->
    <component name="i_CaT">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="Cao" public_interface="in" units="millimolar"/>
        <variable name="P_CaT" public_interface="in" units="nanoA_per_millimolar"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable name="RTONF" public_interface="in" units="millivolt"/>
        <variable name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable name="dT" public_interface="in" units="dimensionless"/>
        <variable name="fT" public_interface="in" units="dimensionless"/>
        <variable name="i_CaT" public_interface="out" units="nanoA"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_CaT</ci>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">2</cn>
                            <ci>P_CaT</ci>
                            <ci>V</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>RTONF</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="dimensionless">1</cn>
                                            </apply>
                                            <ci>V</ci>
                                            <cn cellml:units="dimensionless">2</cn>
                                        </apply>
                                        <ci>RTONF</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>Ca_sub</ci>
                        <apply>
                            <times/>
                            <ci>Cao</ci>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="dimensionless">2</cn>
                                        </apply>
                                        <ci>V</ci>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>dT</ci>
                    <ci>fT</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_CaT_dT_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="dT_init" public_interface="in" units="dimensionless"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="dT_init" name="dT" public_interface="out" units="dimensionless"/>
        <variable name="dT_infinity" units="dimensionless"/>
        <variable name="tau_dT" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>dT_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">38.3</cn>
                                    </apply>
                                </apply>
                                <cn cellml:units="millivolt">5.5</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_dT</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="second">0.001</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">1.068</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">38.3</cn>
                                    </apply>
                                    <cn cellml:units="millivolt">30</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">1.068</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <plus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">38.3</cn>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">30</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>dT</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>dT_infinity</ci>
                        <ci>dT</ci>
                    </apply>
                    <ci>tau_dT</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_CaT_fT_gate">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="fT_init" public_interface="in" units="dimensionless"/>
        <variable name="offset_fT" public_interface="in" units="second"/>
        <variable name="V" public_interface="in" units="millivolt"/>
        <variable initial_value="fT_init" name="fT" public_interface="out" units="dimensionless"/>
        <variable name="fT_infinity" units="dimensionless"/>
        <variable name="tau_fT" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>fT_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">58.7</cn>
                                </apply>
                                <cn cellml:units="millivolt">3.8</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--this formula add an offset coefficient, not the same as paper-->
            <apply>
                <eq/>
                <ci>tau_fT</ci>
                <apply>
                    <plus/>
                    <apply>
                        <divide/>
                        <cn cellml:units="second">1</cn>
                        <apply>
                            <plus/>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">16.67</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <minus/>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">75</cn>
                                            </apply>
                                        </apply>
                                        <cn cellml:units="millivolt">83.3</cn>
                                    </apply>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">16.67</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <plus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">75</cn>
                                        </apply>
                                        <cn cellml:units="millivolt">15.38</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>offset_fT</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>fT</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>fT_infinity</ci>
                        <ci>fT</ci>
                    </apply>
                    <ci>tau_fT</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--**************************end current module****************//-->
</model>
